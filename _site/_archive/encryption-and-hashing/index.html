



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="module">
      document.documentElement.classList.remove('no-js');
      document.documentElement.classList.add('js');
    </script>
    
    <title>Encryption &amp; Hashing</title>
    <meta name="description" content="Uses and praxis of encryption &amp; hashing in secure web applications.">
    <meta property="og:title" content="Encryption &amp; Hashing">
    <meta property="og:description" content="Uses and praxis of encryption &amp; hashing in secure web applications.">
    <meta property="og:url" content="">
    <link rel="canonical" href="">

    <meta property="og:image" content="https://meek-tarsier-01cebe.netlify.app/">
    <meta property="og:image:alt" content="Decent Internet">
    <meta property="og:locale" content="en_CA">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" href="/icons/favicon.ico">
    <link rel="icon" href="/icons/d-i.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#FFF464">
    <script src="/js/alpine.js" defer></script>
    <script src="/js/script.js" defer></script>
    
  </head>
  <body
    data-difficulty="3" 
    x-data 
    
    :class="$store.menuToggle.on && 'no-scroll'">
    <a href="#content" class="show-for-sr show-on-focus skip-link">Skip navigation</a>

    <div class="progress" aria-hidden="true"></div>
    <header class="header">
      <div class="nav">
        <nav>
          
          <button 
            x-data 
            @click="$store.menuToggle.toggle();document.getElementById('navBarClose').focus();" 
            id="navBarOpen" 
            class="nav__toggle-button hide-without-js">
            <svg 
              width="48" 
              height="48" 
              viewBox="0 0 512 512" 
              xmlns="http://www.w3.org/2000/svg" 
              role="img">
              <title>Show menu</title>
              <path d="M32 96v64h448V96H32zm0 128v64h448v-64H32zm0 128v64h448v-64H32z" class="svg-fill" />
            </svg>
          </button>

          <div 
            x-data 
            class="nav__links" 
            :class="$store.menuToggle.on && 'nav__links--expanded'" 
            :aria-expanded="$store.menuToggle.on ? 'true' : 'false'">
            <div class="nav__links-close-target hide-without-js">
              <button 
                x-data 
                @click="$store.menuToggle.toggle();document.getElementById('navBarOpen').focus();" 
                id="navBarClose" 
                class="nav__toggle-button nav__toggle-button--close">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
                  <title>Hide menu</title>
                  <path d="M8 8L40 40" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" class="svg-fill"/>
                  <path d="M8 40L40 8" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" class="svg-fill"/>
                </svg>
              </button>
            </div>          
            <ul>
              <li><a href="/">Home</a></li>
              <li><a href="/about">About</a></li>
              <li><a href="/socials">Socials</a></li>
            </ul>
          </div>

          <button 
            x-data 
            class="nav__toggle-tap-to-close hide-without-js" 
            :class="$store.menuToggle.on && 'nav__toggle-tap-to-close--open'" 
            @click="$store.menuToggle.toggle();document.getElementById('navBarOpen').focus();" 
            tabindex="-1">Hide menu with tap</button>

        </nav>

        <h1 id="content" class="title">Encryption & Hashing</h1>

        
        <div class="search__box hide-without-js">
          <label for="search" class="show-for-sr">Type to search</label>
          <input id="search" placeholder="Search" class="search__input hide-without-js">
          <svg width="48" height="48" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 183.792 183.792" xml:space="preserve" class="search__box-icon" role="img">
            <title>Search</title>
            <path class="svg-fill" d="M54.734,9.053C39.12,18.067,27.95,32.624,23.284,50.039c-4.667,17.415-2.271,35.606,6.743,51.22
              c12.023,20.823,34.441,33.759,58.508,33.759c7.599,0,15.139-1.308,22.287-3.818l30.364,52.592l21.65-12.5l-30.359-52.583
              c10.255-8.774,17.638-20.411,21.207-33.73c4.666-17.415,2.27-35.605-6.744-51.22C134.918,12.936,112.499,0,88.433,0
              C76.645,0,64.992,3.13,54.734,9.053z M125.29,46.259c5.676,9.831,7.184,21.285,4.246,32.25c-2.938,10.965-9.971,20.13-19.802,25.806
              c-6.462,3.731-13.793,5.703-21.199,5.703c-15.163,0-29.286-8.146-36.857-21.259c-5.676-9.831-7.184-21.284-4.245-32.25
              c2.938-10.965,9.971-20.13,19.802-25.807C73.696,26.972,81.027,25,88.433,25C103.597,25,117.719,33.146,125.29,46.259z"/>
          </svg>
          <ul aria-live="polite" id="searchResults" class="search__results"></ul>
        </div>
      </div>

      <svg width='0' height='0' xmlns='http://www.w3.org/2000/svg' role="presentation">
        <defs>
          <pattern id='a' patternUnits='userSpaceOnUse' width='20' height='20'>
            <rect x='0' y='0' width='100%' />
            <path d='M 10,-2.55e-7 V 20 Z M -1.1677362e-8,10 H 20 Z' stroke-width='0.5' class="svg-fill" fill='none' />
          </pattern>
        </defs>
      </svg>

      
        <div class="callout summary-container">
          
            <div class="summary">
              <div class="summary__text-container">
                <span class="summary__text" data-annotate>Uses and praxis of encryption &amp; hashing in secure web applications.</span>
              </div>
              <div class="summary__reading-time"></div>
              <div class="summary__date">Thu, 14 Apr 2022 19:17:45 GMT</div>
              
            </div>
          
          
        </div>
      

    </header>

    <main>
      

      
      <article>
        
        <div class="body-spacer--small"></div>
<p style="margin-bottom: 1rem;"></p>
<section>
    <h2 class="text-center">Table of Contents</h2>
    <ul>
        <li><a href="#what-is-encryption">What is Encryption?</a>
            <ul>
                <li><a href="#when-do-i-use-it">When do I use it?</a>
                    <ul class="post-only">
                        <li><a href="#states">States of data</a></li>
                    </ul>
                </li>
                <li><a href="#in-transit">Encrypting Data in Transit</a></li>
                <li><a href="#at-rest">Encrypting Data at Rest</a>
                    <ul class="post-only">
                        <li><a href="#how-does-it-work">How does encryption work?</a>
                            <ul>
                                <li><a href="#symmetric-vs-asymmetric">Symmetric vs. Asymmetric encryption</a></li>
                            </ul>
                        <li><a href="#encryption-libraries">Encryption libraries</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><a href="#what-is-hashing">What is Hashing?</a>
            <ul>
                <li><a href="#SHA">Hashing with SHA</a></li>
            </ul>
        </li>
        <li><a href="#what-is-salting">What is Salting?</a></li>
        <li><a href="#where-to-store">Where to store your passwords/keys/salts</a></li>
        <li><a href="#pros">How the pros do it</a>
            <ul>
                <li><a href="#security-at-stripe">Security at Stripe</a></li>
            </ul>
        </li>
        <li><a href="further-reading">Continuing your security journey</a></li>
    </ul>
</section>
<div class="body-spacer"></div>
<section id="what-is-encryption"><img class="body-icon" alt="" src="/images/security.svg">
    <h2>What is Encryption?</h2>
    <p>Encryption is the process of turning data into other data, data which <strong>can only be made meaningful <em>if you know how to decrypt it</em></strong>.</p>
</section>
<section id="when-do-i-use-it">
    <h3 class="text-center">When do I use it?</h3>
    <p>You should <strong>encrypt any data</strong> your organization has deemed "<strong>sensitive</strong>", both in transit and at rest.</p>
</section>
<section id="states">
    <h4>States of data</h4>
    <p>Data is generally thought of as having three "states". Just like matter can be a liquid, solid or gas<sup><a href="#footnote1">1</a></sup>, data can be "<strong>in transit</strong>" (or "in motion"), "<strong>in use</strong>", or "<strong>at rest</strong>".</p>
</section>
<section>
    <p>Data "in use" is a reference to data being stored in volatile memory, i.e. RAM. We could extend this metaphor to data displayed and edited in the web browser, but either way it's generally thought of as being the end-user's problem, and there's not much we can do about encrypting it, so we're not going to bother with it much today.</p>
</section>
<section>
    <p>For our purposes, we can think of data "in transit" as being <strong>data transmitted</strong> from a client (like a browser) to our web server, or the reverse.</p>
    <p>Data "at rest" is <strong>data stored</strong> in non-volatile memory, like in our database.</p>
    <p>You should think of it as <strong>your responsibility to encrypt data that is "in transit" or "at rest"</strong>.</p>
</section>
<div class="body-spacer--small"></div>
<section id="in-transit">
    <h3 class="text-center">Encrypting Data in Transit</h3>
    <p>Great news! We <a href="/posts/how-to-not-get-hacked/#https-and-tls" target="_blank">learned how to do this last week</a>, and it's pretty easy.</p>
    <ol>
        <li>Get an <strong>SSL certificate</strong> for your website</li>
        <li>Set your <strong><code>Strict-Transport-Security</code> HTTP header</strong> to make https mandatory.</li>
    </ol>
</section>
<div class="body-spacer--small"></div>
<section id="at-rest">
    <h3 class="text-center">Encrypting Data at Rest</h3>
    <p>Ok, step 1: use <strong>an encryption library</strong>, not some "roll-your-own" solution.</p>
    <p><a href="#encryption-libraries">More on encryption libraries in a moment</a>.</p>
</section>
<section id="how-does-it-work">
    <h4>How does encryption work?</h3>
        <p>Let's take a look at a (very, very simple, and therefore very, very bad) example of encryption:</p>
        <p class="codepen" data-height="300" data-theme-id="default" data-default-tab="html,result" data-slug-hash="jOmwRad" data-user="simonborer" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;"></p>
        <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
        <p class="callout warning post-only">If you're just reading along in the notes without the accompanying lecture, make sure you check out the comments in the JavaScript.</p>
</section>
<section>
    <p>While in this example, we used a single formula (letter + 1), a proper encryption algorithm would have a <strong>different formula every time</strong> it encrypts data. <strong>To know the formula</strong> used to encrypt a particular block of data, <strong>you need the "key"</strong>.</p>
</section>
<section id="symmetric-vs-asymmetric">
    <h5>Symmetric vs. Asymmetric encryption</h5>
    <p>If you use <strong>the same key to encrypt and decrypt</strong>, this is known as "symmetric key encryption".</p>
    <p>If <strong>different keys</strong> are used to encrypt and decrypt (usually a 'public' key and a 'private' key), this is known as "asymmetric encryption". In some asymmetric encryption algorithms, both the public key and private key can encrypt, but only the private key can decrypt. Asymmetric encryption is pretty computationally expensive, so it's usually <strong>only used to secure small amounts of data</strong>, like keys themselves.</p>
</section>
<section>
    <h6>RSA (asymmetric) encryption</h6>
    <p>"RSA" is an example of asymmetric encryption - brought to you by the same people who make those little authentication fobs.</p>
    <figure style="display:flex;flex-direction: column;justify-content:center;"><img src="/images/rsa-fob.gif" alt="RSA fob">
        <figcaption>This key fob provides authentication, but the same company provides encryption tools.</figcaption>
    </figure>
</section>
<section>
    <div class="callout primary">The way I remember that RSA is asymmetric encryption is by remembering that we use asymmetric encryption with <strong>R</strong>eally <strong>S</strong>mall <strong>A</strong>mounts of data ;)</div>
</section>
<section>
    <h6>AES (symmetric) encryption</h6>
    <p>The current <strong>gold-standard of symmetric encryption</strong> (encryption with a single key) is AES. AES is the only publicly-available encryption method deemed secure enough to secure top-secret information for the U.S. government, so it's pretty solid.</p>
</section>
<section>
    <p>As previously mentioned, despite the availability of powerful encryption algorithms like AES, you should not be attempting to create your own encryption library.</p>
</section>
<div class="body-spacer--small"></div>
<section id="encryption-libraries">
    <h4>Encryption libraries</h4>
    <p>Currently, there are two libraries that are very well-regarded and available for use in most contexts (Node, PHP, .NET, etc.): <a href="https://github.com/openssl/openssl" target="_blank" rel="noopener noreferrer">OpenSSL<span class="show-for-sr"> Opens in a new window</span></a> and <a href="https://libsodium.gitbook.io/doc/" target="_blank" rel="noopener noreferrer">libsodium<span class="show-for-sr"> Opens in a new window</span></a>.</p>
</section>
<section>
    <p>If you're wondering what the difference is - OpenSSL is considered more <strong>interoperable</strong> and "<strong>future-proof</strong>", while libsodium is considered more "<strong>idiot-proof</strong>". It's possible to choose older, less secure encryption through OpenSSL, whereas with libsodium, if you've got it working, you're pretty much ok. That being said, libsodium is harder to <em>keep</em> working as security threats evolve over the years and your application grows more complex.</p>
</section>
<div class="body-spacer--small"></div>
<section id="openssl">
    <h5>Using OpenSSL</h5>
    <p>Let's look at a very simple example, where we use OpenSSL through the command line (one of the many places, including most server-side code, that you can use OpenSSL).</p>
    <pre><code class="language-bash">openssl enc -aes-256-cbc -e -salt -in my-diary.txt -out nz-ejbsz.txt</code></pre>
</section>
<section>
    <p>Broken down,</p>
    <ul>
        <li><code>openssl</code> calls the command line application 'openssl',</li>
        <li><code>enc</code> calls the method for using encryption/decryption ciphers,</li>
        <li><code>-aes-256-cbc</code> specifies the algorithm with which we will encrypt our data - in this case, AES with a key 256 bits long, using the Cipher Block Chaining mode, </li>
        <li><code>-e</code> means we will be encrypting the data,</li>
        <li><code>-salt</code> means we will be adding a "salt" to our data - an extra layer of security, which <a href="#what-is-salting">we'll talk about shortly</a></li>
        <li class="post-only"><code>-in</code> means the next thing in the command will be our input source, the thing getting encrypted</li>
        <li class="post-only"><code>my-diary.txt</code> is the input source, a file in the working directory (i.e. the same folder where this command is run),</li>
        <li class="post-only"><code>-out</code> means we're about to specify the output destination, the place where our output data goes, and finally</li>
        <li class="post-only"><code>nz-ejbsz.txt</code> is the file where we'll put our encrypted data.</li>
    </ul>
</section>
<section class="slide-only">
    <ul>
        <li><code>-in</code> means the next thing in the command will be our input source, the thing getting encrypted</li>
        <li><code>my-diary.txt</code> is the input source, a file in the working directory (i.e. the same folder where this command is run),</li>
        <li><code>-out</code> means we're about to specify the output destination, the place where our output data goes, and finally</li>
        <li><code>nz-ejbsz.txt</code> is the file where we'll put our encrypted data.</li>
    </ul>
</section>
<section>
    <figure>
        <img src="/images/openssl-encrypt.png" alt="Encrypting a file in the command line">
    </figure>
    <p>At this point, you're prompted to enter and confirm a password. After that, `nz-ejbsz.txt` gets created (if it didn't already exist).</p>
</section>
<section>
    <p>This:</p>
    <pre><code class="language-console">10/09/2001
Ugh, it's my turn with these stupid 'travelling pants'. I don't care what Lena, Tibby, Bridget, and Carmen say, they totally stretched them out. I hear some lady wrote a book about us, and it's coming out tomorrow. That will definitely be the worst thing that happens in the whole world. The only thing that could possibly be worse is if they wrote me out of the book.</code></pre>
</section>
<section>
    <p>…becomes this:</p>
    <pre><code class="language-console">5361 6c74 6564 5f5f 8456 721a 878a 5dd8
6a46 a2cc d47d 9268 eb7d beac e1ea 4300
c4f9 49d5 138e 27f8 ddbf e4fd bfce 7abc
e75b 7b2c 0241 29f7 459b c47c 9e91 8ac3
e258 90c2 3693 14a1 4a1b 45bc 9883 b16f
8e37 a854 9699 18cb 7660 5033 1c7f 13ca
599f 3687 f2fc 7dda 5d0d 34c9 db33 16eb
d67f d6b6 bfff b142 31ae a451 1095 6213
68ee fa5a a1b1 5795 0870 8fde c081 2e52
5c10 fcd9 a098 580d e49d 8aa5 7eee f703
de39 8028 669f e62c 944c 3fdd 5eb3 5719
2f3a 420a 7ae1 87b5 1ec4 9d78 829d eb93
a3ec 1592 2761 49b0 e78c 8fe9 6b16 f9b6
e9e7 337a fec0 9a2e 504b 14eb e565 f83e
b5f5 b46e f1b9 5d49 6b41 d6d8 909a c478
86fe b1fe efad 5045 c67d 8496 286a ad0d
08e8 8dc3 eb65 0a44 9f6d e40a 2bc8 002f
b4b8 81c1 9b7e f9f7 37fb a037 58bd e5b8
d160 6239 e306 38e5 5e07 f2d8 b962 a968
3a20 bda3 1c09 6239 9c02 af4c 5909 27cb
9bfc b8ab 22fa 7790 20f4 4712 df29 841e
cdc0 d265 b5ec b7f0 dd56 bc73 ace2 eac9
54eb 5f4e 5514 1fc9 3ab0 b2fb ba24 b82b
50ea b7ed 85a7 80f1 339c 1f24 0dea 5e5a
a62f 3dfb 963b e6bc 6c3d e5f6 5a6b 6908
ad4f ca6e 0808 e25f 5adb 0428 f9d0 b41f
d8c4 87ce 5034 368b 4bc5 23b0 7ca1 b62d
fcb4 8e81 2224 60d2 0c24 3fa3 56d7 5154
cbcc e0c3 27af 6572 69e4 1a99 2d0e 9c6d
58c8 2b1a f040 06dc 5e79 64f8 81b4 bdf5
0735 8660 d286 6c8b e642 e225 8e5c e4d7
31c8 25bf dd49 9a5b 2f5b 716d 7669 9d79
071b 827f 728f 3a0b 4300 ae39 5aab c9f9
3296 e315 e895 ee63 d679 5326 16ac 542f</code></pre>
</section>
<section>
    <p>The command to decrypt is almost identical:</p>
    <pre><code class="language-bash">openssl enc -aes-256-cbc -d -in nz-ejbsz.txt -out got-your-diary.txt</code></pre>
    <p>The only differences are that <code>-e</code> becomes <code>-d</code>, the input is set to the encrypted file, and the output is set to a new file.</p>
</section>
<section>
    <figure>
        <img src="/images/openssl-decrypt.png" alt="Decrypting a file in the command line">
    </figure>
</section>
<section>
    <p>We're prompted for the password again, and this:</p>
    <pre><code class="language-console">5361 6c74 6564 5f5f 8456 721a 878a 5dd8
6a46 a2cc d47d 9268 eb7d beac e1ea 4300
c4f9 49d5 138e 27f8 ddbf e4fd bfce 7abc
e75b 7b2c 0241 29f7 459b c47c 9e91 8ac3
e258 90c2 3693 14a1 4a1b 45bc 9883 b16f
8e37 a854 9699 18cb 7660 5033 1c7f 13ca
599f 3687 f2fc 7dda 5d0d 34c9 db33 16eb
d67f d6b6 bfff b142 31ae a451 1095 6213
68ee fa5a a1b1 5795 0870 8fde c081 2e52
5c10 fcd9 a098 580d e49d 8aa5 7eee f703
de39 8028 669f e62c 944c 3fdd 5eb3 5719
2f3a 420a 7ae1 87b5 1ec4 9d78 829d eb93
a3ec 1592 2761 49b0 e78c 8fe9 6b16 f9b6
e9e7 337a fec0 9a2e 504b 14eb e565 f83e
b5f5 b46e f1b9 5d49 6b41 d6d8 909a c478
86fe b1fe efad 5045 c67d 8496 286a ad0d
08e8 8dc3 eb65 0a44 9f6d e40a 2bc8 002f
b4b8 81c1 9b7e f9f7 37fb a037 58bd e5b8
d160 6239 e306 38e5 5e07 f2d8 b962 a968
3a20 bda3 1c09 6239 9c02 af4c 5909 27cb
9bfc b8ab 22fa 7790 20f4 4712 df29 841e
cdc0 d265 b5ec b7f0 dd56 bc73 ace2 eac9
54eb 5f4e 5514 1fc9 3ab0 b2fb ba24 b82b
50ea b7ed 85a7 80f1 339c 1f24 0dea 5e5a
a62f 3dfb 963b e6bc 6c3d e5f6 5a6b 6908
ad4f ca6e 0808 e25f 5adb 0428 f9d0 b41f
d8c4 87ce 5034 368b 4bc5 23b0 7ca1 b62d
fcb4 8e81 2224 60d2 0c24 3fa3 56d7 5154
cbcc e0c3 27af 6572 69e4 1a99 2d0e 9c6d
58c8 2b1a f040 06dc 5e79 64f8 81b4 bdf5
0735 8660 d286 6c8b e642 e225 8e5c e4d7
31c8 25bf dd49 9a5b 2f5b 716d 7669 9d79
071b 827f 728f 3a0b 4300 ae39 5aab c9f9
3296 e315 e895 ee63 d679 5326 16ac 542f</code></pre>
</section>
<section>
    <p>…becomes this:</p>
    <pre><code class="language-console">10/09/2001
Ugh, it's my turn with these stupid 'travelling pants'. I don't care what Lena, Tibby, Bridget, and Carmen say, they totally stretched them out. I hear some lady wrote a book about us, and it's coming out tomorrow. That will definitely be the worst thing that happens in the whole world. The only thing that could possibly be worse is if they wrote me out of the book.</code></pre>
</section>
<div class="body-spacer--small"></div>
<section>
    <h5>Encryption learning curves</h5>
    <p>Now at this point, if we were able to devote the entire semester to encryption workflows, we might build an encrypted Node or PHP application that can store a user's password and credit card info and deepest, darkest secrets, but I have to draw a line at a certain point to make it really clear that <strong>what we're learning is not sufficient to build a secure application</strong>. To go much further, we'd be hitting a huge jump in the learning curve, where we talk about…</p>
</section>
<section>
    <ul>
        <li>random vs. pseudo-random</li>
        <li>AES modes</li>
        <li>bit-lengths of keys</li>
        <li>asynchronous coding</li>
        <li>the UINT8 data type</li>
        <li>initialization vectors (IVs, which are nonces (number occurring once(s)) - although while all IVs are nonces, not all nonces are IVs)</li>
    </ul>
</section>
<section>
    <p>…and that's just to take the next step into a discussion of secure full-stack architecture. This is absolutely not something you'll be tasked with in your first job. Or third or fifth. Bigger places have <strong>security specialists</strong>, and smaller places use <strong>3rd-party APIs</strong> to handle things like online payments and user authorization.</p>
    <p>Today, towards the end of the lesson, we'll look at <strong>how service providers handle security</strong>, and I'll provide you with a <strong>reading list</strong> of great materials if you want to keep going ahead with learning about full-stack web application security, but, trust me, <strong>you've come a long way in a short while</strong> if you can read half of today's lesson without your eyes crossing.</p>
</section>
<section>
    <video style="width:480px;height:270px;margin-bottom: .5rem" name="media" controls>
        <source src="/images/paul_rudd.mp4" type="video/mp4"></video>
</section>
<div class="body-spacer"></div>
<section id="what-is-hashing"><img class="body-icon" alt="" src="/images/hashing.svg">
    <h2>What is Hashing?</h2>
    <p>Hashing, like encryption, is <strong>turning data into something indecipherable</strong>. Unlike encryption, however, <strong>with hashing, you can never turn the data back</strong>.</p>
</section>
<section>
    <p>So is your data just lost forever? Well, kind of. But it's still useful. It's all about asking the right question.</p>
</section>
<div class="body-spacer--small"></div>
<section id="SHA">
    <h3>Hashing with SHA</h3>
    <p>Let's say I were to use one of the most secure hash functions, <a href="https://en.wikipedia.org/wiki/SHA-2" target="_blank" rel="noopener noreferrer">SHA-256<span class="show-for-sr"> Opens in a new window</span></a>. I hash 'password1234' and get the value <code>b9c950640e1b3740e98acb93e669c65<br>766f6670dd1609ba91ff41052ba48c6f3</code></p>
    <p class="codepen" data-height="300" data-theme-id="default" data-default-tab="js,result" data-slug-hash="jOmaMGZ" data-user="simonborer" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
    </p>
    <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
</section>
<section>
    <p><code>b9c950640e1b3740e98acb93e669c65<br>766f6670dd1609ba91ff41052ba48c6f3</code> is <strong>impossible to reverse-engineer</strong> to get the value 'password1234'.</p>
    <p>'password1234' is effectively gone, and all we're left with is <code>b9c950640e1b3740e98acb93e669c65<br>766f6670dd1609ba91ff41052ba48c6f3</code> (which I'll start referring to as <code>theHash</code> for brevity's sake).</p>
</section>
<section>
    <p>However, what you <em>can</em> do is <strong>check to see if values match <code>theHash</code></strong>. Hashing always returns the same output when provided the same input.</p>
    <p>What hashing lets you do is <strong>avoid storing sensitive data</strong>. You can 100% never store a user's password, but still have the ability to check if a user's password is correct.</p>
</section>
<section>
    <p>In other words, the wrong question is <em>"What is the original value of the hash?"</em></p>
    <p>The right question is <em>"does <code>thisHash</code> equal <code>theHash</code>?"</em></p>
</section>
<section>
    <p><em>Okay, but doesn't that still <strong>leave us vulnerable</strong> to credential stuffing, or dictionary attacks, like trying the top 10 million passwords?</em></p>
    <p>I mean, hopefully you're limiting the rate/number of attempted logins, but if someone were able to get around that, then yes! Hackers have some <a href="https://en.wikipedia.org/wiki/Rainbow_table" target="_blank" rel="noopener noreferrer">pretty&nbsp;<del>cool</del>&nbsp;<ins>advanced</ins><span class="show-for-sr"> Opens in a new window</span></a> ways of cracking hashes.</p>
</section>
<section>
    <p>Hashing is funny, because it's kinda like the decryption password for each bit of hashed data is the data itself.</p>
    <p>We can defend against attacks like credential stuffing by <strong>adding an additional password</strong> to the user's password. This is known as a 'salt'.</p>
</section>
<div class="body-spacer"></div>
<section id="what-is-salting">
    <img class="body-icon" alt="" src="/images/salt.svg">
    <h2>What is Salting?</h2>
</section>
<section>
    <p>A 'salt' is basically <strong>an extra password that you generate for a user</strong>, added to the end of their password.</p>
    <p>This means that two users will never have the same password, and a hacker can't decode a list of hashed passwords by themselves.</p>
    <p>Before you hash their password, you <strong>add the extra password</strong> (the salt) <strong>to the end of the password they've supplied</strong>. You <strong>don't save their password</strong>, but <strong>you <em>do</em> store the salt</strong>.</p>
    <p>Salts are "<a href="https://en.wikipedia.org/wiki/Cryptographically-secure_pseudorandom_number_generator" target="_blank" rel="noopener noreferrer">cryptographically secure<span class="show-for-sr"> Opens in a new window</span></a>" random strings generated by your encryption library.</p>
</section>
<section>
    <p class="codepen" data-height="300" data-theme-id="default" data-default-tab="js,result" data-slug-hash="ExmbZqe" data-user="simonborer" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;"></p>
    <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
</section>
<section>
    <p>This means that a hacker would need to <strong>get into your database</strong>, <strong>defeat your database encryption</strong>, <strong>get the users' salts</strong>, and <em>then</em> <strong>perform their dictionary attack</strong> against the passwords.</p>
    <p>At this point, you've made it much easier for hackers to simply cold-call people and say, "uh, hey, it's… Bill, from the I.T. department - can you tell me your username and password?". In other words, <strong>your job is done</strong>.</p>
</section>
<div class="body-spacer"></div>
<section id="where-to-store">
    <h2>Where to store your passwords/keys/salts.</h2>
    <p>Okay, at this point you've probably noticed that <strong>administrative passwords are still important</strong> for authenticating who is allowed to decrypt things, verify passwords, etc.</p></section>
<section><p>Obviously, you don't want to have to type in a password every time a user creates an account, so they need to be stored somewhere. But if a hacker <strong>gets into an encrypted database, and the encryption key is stored in that same database</strong>, it's like leaving the key to your house just sitting in the lock.</p>
    <img src="/images/key-in-door-locks.png" alt="Key forgotten in lock">
</section>
<section>
    <p>If you're in charge of your own hardware, <strong>there are <a href="https://en.wikipedia.org/wiki/Hardware_security_module" target="_blank" rel="noopener noreferrer">extra-secure devices<span class="show-for-sr"> Opens in a new window</span></a> called "hardware security modules"</strong> that you can use to store keys and perform encryption, instead of doing it on your regular server. If someone breaches your server, they still have to get into this thing:</p>
    <img src="/images/hsm.png" alt="A hardware security module">
</section>
<section>
    <p>Similar devices can also come in the form of <a href="https://github.com/solokeys/solo" target="_blank" rel="noopener noreferrer">small, portable keys<span class="show-for-sr"> Opens in a new window</span></a> for the security-minded person on the go.</p>
    <img src="/images/hsm-key.png" alt="A hardware security key">
</section>
<section>
    <p>At very least, you should be <strong>storing your passwords on a separate server from the encrypted data</strong>. That way, a hacker would need to hack into both your web server and your database server.</p>
    <figure>
        <img src="/images/hide-a-key.jpeg" alt="A key hidden in a rock">
        <figcaption>The web security equivalent of a "hide-a-key"</figcaption>
    </figure>
</section>
<div class="body-spacer"></div>
<section id="pros">
    <h2>How the pros do it</h2>
    <p>As I mentioned before, smaller shops (and big ones, too!) will often <strong>choose not to handle secure data, like credit card transactions</strong>. The most popular option for this is Paypal. The second most popular is called Stripe. Today we're going to talk about how Stripe secures their data (because <a href="https://stripe.com/docs/security/stripe" target="_blank" rel="noopener noreferrer">Stripe's documentation<span class="show-for-sr"> Opens in a new window</span></a> is much nicer to read).</p>
</section>
<div class="body-spacer--small"></div>
<section id="security-at-stripe">
    <blockquote>
        <h3 style="margin-top: .5em;">HTTPS and HSTS for secure connections</h3>
    </blockquote>
    <p>Hey, <a href="/posts/how-to-not-get-hacked/#https-and-tls">we know how to do that</a>! HTTPS just means having an SSL certificate, and HSTS just means setting your <code>Strict-Transport-Security</code> header.</p>
</section>
<div class="body-spacer--small"></div>
<section>
    <blockquote>
        <h3 style="margin-top: .5em;">Encryption of sensitive data and communication </h3>
        <p>All card numbers are encrypted at rest with AES-256. Decryption keys are stored on separate machines. None of Stripe’s internal servers and daemons can obtain plaintext card numbers but can request that cards are sent to a service provider on a static allowlist. Stripe’s infrastructure for storing, decrypting, and transmitting card numbers runs in a separate hosting environment, and doesn’t share any credentials with Stripe’s primary services (API, website, etc.).</p>
    </blockquote>
</section>
<section>
    <p>Okay, we don't know how to do all this stuff, but with today's lesson we know <em>about</em> them.</p>
    <ul>
        <li>✅ <em>…encrypted at rest with AES-256</em></li>
        <li>✅ <em>…keys are stored on separate machines</em> (HSM)</li>
        <li>✅ <em>…None of Stripe’s internal servers and daemons can obtain plaintext card numbers but can request that cards are sent to a service provider on a static allowlist</em> (whitelisting/blacklisting)</li>
        <li>✅ <em>…infrastructure for storing, decrypting, and transmitting card numbers runs in a separate hosting environment</em> (separate server)</li>
    </ul>
</section>
<div class="body-spacer--small"></div>
<section>
    <blockquote>
        <h3 style="margin-top: .5em;">Vulnerability disclosure and reward program</h3>
        <p>Stripe maintains a private, invite-only bug bounty program, with the assistance of HackerOne.</p>
    </blockquote>
    <p>This is pretty cool, and a not uncommon technique. "Bug bounties" are <strong>rewards that companies offer for finding security problems</strong>. In other words, they pay hackers for telling them they're vulnerable.</p>
    <p>Sometimes bug bounties are public, and sometimes they're run through an organization like <a href="https://www.hackerone.com/" target="_blank" rel="noopener noreferrer">HackerOne<span class="show-for-sr"> Opens in a new window</span></a>, which has paid out >$100 million dollars in bounties.</p>
</section>
<div class="body-spacer"></div>
<section id="further-reading">
    <div class="further-reading" >
    <h2 style="margin-top:0">Continuing your security journey</h2>
    <strong>Further Reading:</strong>
    <ul>
        <li><a href="https://online.stanford.edu/courses/xcs100-introduction-web-security" target="_blank" rel="noreferrer">Introduction to Web Security<span class="show-for-sr"> Opens in a new window</span></a>, <em>Stanford University</em> Free course</li>
        <li><a href="https://www.oreilly.com/library/view/web-application-security/9781492053101/" target="_blank" rel="noopener noreferrer">Web Application Security<span class="show-for-sr"> Opens in a new window</span></a>, <em>O'Reilly</em></li>
        <li><a href="https://portswigger.net/web-security/all-materials" target="_blank" rel="noopener noreferrer">All learning materials<span class="show-for-sr"> Opens in a new window</span></a>, <em>Web Security Academy</em> (from the people who brought us The Web Application Hacker's Handbook)</li>
        <li><a href="https://www.freecodecamp.org/news/best-practices-for-building-api-keys-97c26eabfea9/" target="_blank" rel="noopener noreferrer">Best practices for building secure API Keys<span class="show-for-sr"> Opens in a new window</span></a>, <em>freeCodeCamp</em></li>
    </ul>
    </div>
</section>
<div class="body-spacer"></div>
<section><span style="font-size:4vw">That's it!</span></section>
<div class="body-spacer"></div>
<section>
    <hr>
    <h2 style="font-size:1.1em">Footnotes</h2>
    <ol>
        <li id="footnote1">Ugh, ok nerds, also plasma and liquid crystal and fermionic condensate or <em>whatever</em> <a href="#seeFootnote1"><sup aria-hidden="true">⇧</sup><span class="show-for-sr">Back to "States of data"</span></a></li>
    </ol>
</section>
      </article>

    </main>

    <footer>
      <svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg' role="presentation" class="footer-bg">
        <rect width='100%' height='100%' fill='url(#a)' />
      </svg>
      <div class="copyright row">
        <div class="copyright__info">
        &copy;&nbsp;2022 Simon&nbsp;Borer
        </div>
      </div>
    </footer>

    <script src="/js/fuse.js"></script>
    <script>
      // Let 11ty populate an array of pages
      const searchArray = [{ 
          "url": "/",
          "title": "Decent Internet",
          "tags": []
        },{ 
          "url": "/build-tools/",
          "title": "Build Tools",
          "tags": ["Task runners","Toolchains","Bundlers","Vite","SASS"]
        },{ 
          "url": "/tags/all/",
          "title": "",
          "tags": []
        },{ 
          "url": "/rough-guide-to-getting-a-job/",
          "title": "Rough Guide: How To Get a Job &lt;wbr&gt;as a Web Developer &lt;wbr&gt;in&amp;nbsp;2022",
          "tags": ["OWASP","XSS","SQL Injection","Security","Authentication"]
        },{ 
          "url": "/web-life-cycle/slides/",
          "title": "Different jobs in a web&amp;nbsp;project",
          "tags": ["Market research","Personas","Requirements","Design","Wireframes","Development","Unit testing","Code review","Version control","QA","Quality assurance","Analytics"]
        },{ 
          "url": "/carbon-footprint/",
          "title": "The carbon footprint of the internet",
          "tags": ["OWASP","XSS","SQL Injection","Security","Authentication"]
        },{ 
          "url": "/tags/Task%20runners/",
          "title": "Task runners",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Toolchains/",
          "title": "Toolchains",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Bundlers/",
          "title": "Bundlers",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Vite/",
          "title": "Vite",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/SASS/",
          "title": "SASS",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/OWASP/",
          "title": "OWASP",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/XSS/",
          "title": "XSS",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/SQL%20Injection/",
          "title": "SQL Injection",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Security/",
          "title": "Security",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Authentication/",
          "title": "Authentication",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Market%20research/",
          "title": "Market research",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Personas/",
          "title": "Personas",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Requirements/",
          "title": "Requirements",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Design/",
          "title": "Design",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Wireframes/",
          "title": "Wireframes",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Development/",
          "title": "Development",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Unit%20testing/",
          "title": "Unit testing",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Code%20review/",
          "title": "Code review",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Version%20control/",
          "title": "Version control",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/QA/",
          "title": "QA",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Quality%20assurance/",
          "title": "Quality assurance",
          "tags": [],
          "isTag": true
        },{ 
          "url": "/tags/Analytics/",
          "title": "Analytics",
          "tags": [],
          "isTag": true
        }
    ];

    // Set fuse options
    const options = {
      includeScore: true,
      keys: [
        { name: "title", weight: 0.9 },
        { name: "tags", weight: 1 },
      ],
    };

    // Create instance of fuse
    const fuse = new Fuse(searchArray, options);

    const searchBox = document.getElementById("search");
    window.onload = () => (searchBox.value = ``);

    // Give results while typing
    const listenToResults = () => {
      document
        .getElementById("searchResults")
        .querySelectorAll("a")
        .forEach((searchResultLink, index) => {
          searchResultLink.addEventListener("keyup", function () {
            if (
              (index === 0 && event.key === "ArrowUp") ||
              (index + 1 ===
                document.getElementById("searchResults").querySelectorAll("a")
                  .length &&
                event.key === "ArrowDown")
            ) {
              searchBox.focus();
            } else if (event.key === "ArrowUp") {
              document
                .getElementById("searchResults")
                .querySelectorAll("a")
                [index - 1].focus();
            } else if (event.key === "ArrowDown") {
              document
                .getElementById("searchResults")
                .querySelectorAll("a")
                [index + 1].focus();
            } else if (event.key === "Escape") {
              document
                .getElementById("searchResults").innerHTML = ``;
            }
          });
        });
    };

    searchBox.addEventListener("keyup", function () {
      const resultsList = document.getElementById("searchResults");
      resultsList.innerHTML = ``;
      const searchResults = fuse
        .search(searchBox.value)
        .sort((a, b) => a.score - b.score)
        .slice(0, 3);

        if (event.key !== "Escape") {
          searchResults.forEach((result) => {
            resultsList.innerHTML += `<li><a href="${result.item.url}" tabindex="0">${
              result.item.title
            }<span class="pill">${result.item.isTag ? `Tag` : `Page`}</span></a></li>`;
          });

          listenToResults();

          if (resultsList.children.length > 0 && event.key === "ArrowDown") {
            resultsList.firstChild.querySelector("a").focus();
          }
        } else {
          resultsList.innerHTML = ``;
        }
        });

    // Use Alpine to toggle the menu
    document.addEventListener("alpine:init", () => {
      Alpine.store("menuToggle", {
        on: false,
        toggle() {
          this.on = !this.on;
        },
      });
    });

    // Close menu on left swipe
    const touchableElement = document.querySelectorAll(".nav__links")[0];

    touchableElement.addEventListener(
      "touchstart",
      (event) => {
        touchstartX = event.changedTouches[0].screenX;
        touchstartY = event.changedTouches[0].screenY;
      },
      { passive: true }
    );

    touchableElement.addEventListener(
      "touchend",
      (event) => {
        touchendX = event.changedTouches[0].screenX;
        touchendY = event.changedTouches[0].screenY;
        if (touchendX < touchstartX && touchstartX - touchendX > 75) {
          Alpine.store("menuToggle").toggle();
          document.getElementById("navBarOpen").focus();
        }
      },
      { passive: true }
    );

    </script>
    <script src="/js/instantpage-5.1.0.js" type="module" defer></script>
  </body>
  </html>
